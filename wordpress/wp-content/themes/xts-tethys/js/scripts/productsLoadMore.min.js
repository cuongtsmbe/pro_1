!function(p){XTSThemeModule.$document.on("xtsProductTabLoaded xtsPjaxComplete",function(){XTSThemeModule.productsLoadMore()}),XTSThemeModule.productsLoadMore=function(){var r=".xts-load-more.xts-type-shop.xts-action-infinite",u=!1;p(".xts-products").each(function(){var a=p(this),i=[],t=a.attr("id"),s=p('.xts-arrows-loader[data-id="'+t+'"]'),d=p('.xts-ajax-arrows[data-id="'+t+'"]');function o(){var t,o,e;d.length<=0||(e=XTSThemeModule.$window.height()/2,t=XTSThemeModule.$window.scrollTop(),o=a.offset().top-e,e=d.find(".xts-prev").outerHeight(),e=a.height()-e,t<o||o+e<t?(d.removeClass("xts-shown"),s.removeClass("xts-shown")):(d.addClass("xts-shown"),s.addClass("xts-shown")))}d.length<=0||(i[1]={items:a.html(),status:"have-posts"},XTSThemeModule.$window.on("scroll",function(){o()}),setTimeout(function(){o()},500),d.find(".xts-prev, .xts-next").on("click",function(t){t.preventDefault();var o=p(this);if(!u&&!o.hasClass("xts-disabled")){u=!0,clearInterval(void 0);var e=o.parent().data("id"),a=p("#"+e),s=a.data("source"),t=xts_settings.ajaxurl,e=a.data("atts"),d=a.data("paged"),n=o.parent().find(".xts-next"),r=o.parent().find(".xts-prev");if(d++,o.hasClass("xts-prev")){if(d<2)return;d-=2}s={paged:d,atts:e,action:"xts_get_product_"+s};s.atts.loop=a.find(".xts-col").last().data("loop"),l(t,s,"POST",o,i,d,a,function(t){var o;t.items&&(a.hasClass("xts-masonry-layout")?(o=p(t.items),a.html(o).isotope("appended",o),a.imagesLoaded().progress(function(){a.isotope("layout")})):a.html(t.items),c(),a.data("paged",d)),XTSThemeModule.isMobileSize&&p("html, body").stop().animate({scrollTop:a.offset().top-150},400),1<d?r.removeClass("xts-disabled"):r.addClass("xts-disabled"),"no-more-posts"===t.status?n.addClass("xts-disabled"):n.removeClass("xts-disabled")})}}))}),XTSThemeModule.clickOnScrollButton(r,!1),p(".xts-load-more.xts-type-shop").on("click",function(t){var e,a,s,o,d,n;t.preventDefault(),u||(u=!0,n=(e=p(this)).data("id"),a=p("#"+n),s=a.data("source"),o=xts_settings.ajaxurl,t=a.data("atts"),d=a.data("paged"),n="POST",d++,e.addClass("xts-loading"),t={paged:d,atts:t,action:"xts_get_product_"+s},"main_loop"===s?(o=e.attr("href"),n="GET",t={loop:a.find(".xts-col").last().data("loop")}):t.atts.loop=a.find(".xts-col").last().data("loop"),l(o,t,n,e,[],d,a,function(t){var o;t.items&&(a.hasClass("xts-masonry-layout")?(o=p(t.items),a.append(o).isotope("appended",o),a.imagesLoaded().progress(function(){a.isotope("layout")})):a.append(t.items),c(),a.imagesLoaded().progress(function(){XTSThemeModule.clickOnScrollButton(r,!0)}),a.data("paged",d),"main_loop"===s&&e.attr("href",t.nextPage)),"no-more-posts"===t.status&&e.remove()}))});var l=function(t,o,e,a,s,d,n,r){if(s[d])return n.addClass("xts-loading"),void setTimeout(function(){r(s[d]),n.removeClass("xts-loading"),u=!1},300);var i=n.attr("id"),l=p('.xts-arrows-loader[data-id="'+i+'"]');l.addClass("xts-loading"),n.addClass("xts-loading"),"GET"===e&&(t=XTSThemeModule.removeURLParameter(t,"loop")),p.ajax({url:t,data:o,dataType:"json",method:e,success:function(t){s[d]=t,r(t),"yes"===xts_settings.load_more_button_page_url&&(window.history.pushState("","",t.currentPage+window.location.search),p(".woocommerce-breadcrumb").replaceWith(t.breadcrumbs))},error:function(){console.log("ajax error")},complete:function(){a.removeClass("xts-loading"),l.removeClass("xts-loading"),n.removeClass("xts-loading"),u=!1}})},c=function(){XTSThemeModule.$document.trigger("xtsProductLoadMoreReInit")}},p(document).ready(function(){XTSThemeModule.productsLoadMore()})}(jQuery);